(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-461d2eff"],{cd00:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"h",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"i",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"j",(function(){return g}));var i=n("b775"),l=(n("4328"),"/aix/client");function a(){return Object(i["a"])({url:l+"/active_num",method:"get"})}function o(){return Object(i["a"])({url:l+"/online_num",method:"get"})}function r(){return Object(i["a"])({url:l+"/list",method:"get"})}function s(t){return Object(i["a"])({url:l+"/task-logs",params:{token:t},method:"get"})}function c(t){return Object(i["a"])({url:l+"/info",params:{id:t},method:"get"})}function u(t){return Object(i["a"])({url:l+"/task-info",params:{token:t},method:"get"})}function d(t){return Object(i["a"])({url:l+"/log/start",params:{token:t},method:"get"})}function f(t){return Object(i["a"])({url:l+"/log/stop",params:{token:t},method:"get"})}function p(){return Object(i["a"])({url:l+"/log/line",method:"get"})}function g(t){return i["a"].post(l+"/task",{token:t,action:"stop"})}},f331:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("h1",[t._v("在线容器列表")]),t._v(" "),n("el-button",{on:{click:t.fetchData}},[t._v("强制刷新")]),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"auto"},attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",prop:"id",width:"55"},on:{click:t.jumpToLog}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"名称",prop:"name",width:"95"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"宿主IP",prop:"hostIp",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"描述",prop:"info",width:"155"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"创建者ID",prop:"userId",width:"60"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"活动时间",prop:"since",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"GPU驱动",prop:"gpuInfo.driverVersion",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"CUDA",prop:"gpuInfo.cudaVersion",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"GPU数量",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"right",width:"100%",trigger:"hover"}},[n("el-table",{attrs:{data:e.row.gpuInfo.gpus}},[n("el-table-column",{attrs:{prop:"id",label:"编号",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"型号",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{prop:"calPower",label:"算力",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{prop:"temperature",label:"温度",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"powerDraw",label:"当前功率",width:"99"}}),t._v(" "),n("el-table-column",{attrs:{prop:"powerLimit",label:"最大功率",width:"99"}}),t._v(" "),n("el-table-column",{attrs:{prop:"memUsed",label:"已用显存",width:"99"}}),t._v(" "),n("el-table-column",{attrs:{prop:"memAll",label:"显存总量",width:"99"}})],1),t._v(" "),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.gpuInfo.gpuNum))])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"当前任务",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{placement:"right",width:"100%",trigger:"hover"}},[n("el-table",{attrs:{data:e.row.taskBriefInfoList}},[n("el-table-column",{attrs:{prop:"name",label:"名称",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"accessType",label:"权限",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"info",label:"简介",width:"250"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createdTime",label:"创建时间",width:"230"}}),t._v(" "),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"}})],1),t._v(" "),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.firstTaskName))])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"详情",width:"205"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.jumpToManageDialog(e.$index)}}},[t._v("更多")]),t._v(" "),n("el-button",{on:{click:function(n){return t.jumpToLogs(e.row.id)}}},[t._v("实时日志")])]}}])})],1),t._v(" "),n("el-dialog",{attrs:{title:t.dialogDeviceInfo.name,visible:t.dialogVisible,width:"1100px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticStyle:{display:"flex"}},[n("div",{staticStyle:{"margin-right":"5px","font-size":"17px"}},[t._v("Token:")]),t._v(" "),n("div",[n("span",{staticStyle:{"font-size":"17px",color:"darkred","margin-right":"20px"}},[t._v(t._s(t.dialogDeviceInfo.token))])]),t._v(" "),n("div",[n("el-link",{staticClass:"copyBtn",staticStyle:{"font-size":"17px"},attrs:{"data-clipboard-text":t.dialogDeviceInfo.token}},[t._v("复制")])],1)]),t._v(" "),t.dialogDeviceInfo.taskBriefInfoList.length>0?n("h3",[t._v("任务详情")]):t._e(),t._v(" "),t.dialogDeviceInfo.taskBriefInfoList.length>0?n("el-table",{attrs:{data:t.dialogDeviceInfo.taskBriefInfoList}},[n("el-table-column",{attrs:{prop:"name",label:"名称",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"accessType",label:"权限",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"info",label:"简介",width:"250"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createdTime",label:"创建时间",width:"230"}}),t._v(" "),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"}})],1):t._e(),t._v(" "),""!=t.dialogDeviceInfo.runningCmds?n("div",{staticStyle:{display:"flex","margin-top":"15px"}},[n("div",{staticStyle:{"margin-top":"8px","margin-right":"5px","font-size":"17px"}},[t._v("执行指令:")]),t._v(" "),n("el-input",{staticStyle:{width:"90%","font-size":"17px"},attrs:{type:"textarea",color:"darkred",readonly:"true",resize:"none",autosize:{minRows:1,maxRows:5}},model:{value:t.dialogDeviceInfo.runningCmds,callback:function(e){t.$set(t.dialogDeviceInfo,"runningCmds",e)},expression:"dialogDeviceInfo.runningCmds"}})],1):t._e(),t._v(" "),""!=t.dialogDeviceInfo.latestErrors?n("div",{staticStyle:{display:"flex","margin-top":"10px"}},[n("div",{staticStyle:{"margin-top":"8px","margin-right":"5px","font-size":"17px"}},[t._v("报错信息:")]),t._v(" "),n("el-input",{staticStyle:{width:"90%","font-size":"17px"},attrs:{type:"textarea",color:"darkred",readonly:"true",resize:"none",autosize:{minRows:1,maxRows:12}},model:{value:t.dialogDeviceInfo.latestErrors,callback:function(e){t.$set(t.dialogDeviceInfo,"latestErrors",e)},expression:"dialogDeviceInfo.latestErrors"}})],1):t._e(),t._v(" "),t.dialogDeviceInfo.taskBriefInfoList.length>0?n("el-button",{staticStyle:{float:"left"},attrs:{slot:"footer",type:"primary"},on:{click:function(e){return t.stopTask(t.dialogDeviceInfo.token,t.dialogDeviceInfo.taskBriefInfoList[0].name)}},slot:"footer"},[t._v("\n      终止任务\n    ")]):t._e(),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)],1)],1)},l=[],a=(n("7f7f"),n("cd00")),o=n("b311"),r=n.n(o),s={filters:{statusFilter:function(t){var e={published:"success",draft:"gray",deleted:"danger"};return e[t]}},data:function(){return{list:null,autoRefreshTimer:null,closeWaitingTimer:null,dialogVisible:!1,dialogDeviceIndex:0,dialogDeviceInfo:{name:"unknown",runningCmds:"",taskBriefInfoList:[],latestErrors:""},listLoading:!0}},created:function(){var t=this;this.clearTimer(),this.setTimer(),this.listLoading=!0,a["e"]().then((function(e){t.list=e.data.items,t.listLoading=!1}));var e=this,n=new r.a(".copyBtn");n.on("success",(function(t){console.info("Action:",t.action),console.info("Text:",t.text),console.info("Trigger:",t.trigger),e.copySuccess(),t.clearSelection()}))},destroyed:function(){this.clearTimer()},methods:{fetchData:function(){var t=this;a["e"]().then((function(e){t.list=e.data.items,t.dialogDeviceIndex>=t.list.length?t.dialogDeviceInfo={name:"unknown",runningCmds:"",taskBriefInfoList:[],latestErrors:""}:t.dialogDeviceInfo=t.list[t.dialogDeviceIndex]}))},setTimer:function(){var t=this;null===this.autoRefreshTimer&&(this.autoRefreshTimer=setInterval((function(){t.fetchData()}),5e3))},clearTimer:function(){clearInterval(this.autoRefreshTimer),this.autoRefreshTimer=null},jumpToManageDialog:function(t){this.dialogVisible=!0,this.dialogDeviceIndex=t,this.dialogDeviceInfo=this.list[t]},jumpToLogs:function(t){this.$router.push({name:"Client-logs",params:{clientId:t}})},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))},stopTask:function(t,e){var n=this;this.$confirm("确认终止？").then((function(i){a["j"](t),n.fullScreenWaiting(t,e)})).catch((function(t){}))},fullScreenWaiting:function(t,e){var n=this,i=this.$loading({lock:!0,text:"正在停止，请稍后...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});null===this.closeWaitingTimer&&(this.closeWaitingTimer=setInterval((function(){var l;a["f"](t).then((function(t){l=t.data,null!==l&&l.name===e||(n.dialogDeviceInfo.runningCmds="",n.dialogDeviceInfo.taskBriefInfoList=[],n.fetchData(),i.close(),clearInterval(n.closeWaitingTimer),n.closeWaitingTimer=null,n.$message({message:"任务已停止",type:"success"}))}))}),3e3))},copySuccess:function(){this.$message({message:"复制成功",type:"success"})}}},c=s,u=n("2877"),d=Object(u["a"])(c,i,l,!1,null,null,null);e["default"]=d.exports}}]);